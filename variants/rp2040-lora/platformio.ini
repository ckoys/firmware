[env:rp2040-lora]
extends = rp2040_base
board = rpipico
upload_protocol = picotool

# add our variants files to the include and src paths
build_flags = ${rp2040_base.build_flags} 
  -DRP2040_LORA
  -Ivariants/rp2040-lora
  -DDEBUG_RP2040_PORT=Serial
  -DHW_SPI1_DEVICE
  -L "${platformio.libdeps_dir}/${this.__env__}/bsec2/src/cortex-m0plus"
  ; Deaktiviere Bluetooth und WiFi
  -DMESHTASTIC_EXCLUDE_BLUETOOTH
  -DMESHTASTIC_EXCLUDE_WIFI
  ; Deaktiviere Umweltsensoren
  -DMESHTASTIC_EXCLUDE_ENVIRONMENTAL_MEASUREMENTS
  -DMESHTASTIC_EXCLUDE_TEMPERATURE_MEASUREMENTS
  -DMESHTASTIC_EXCLUDE_HUMIDITY_MEASUREMENTS
  -DMESHTASTIC_EXCLUDE_PRESSURE_MEASUREMENTS
  -DMESHTASTIC_EXCLUDE_AIR_QUALITY_MEASUREMENTS
  ; Weitere Hardware-spezifische Ausschlüsse
  -DMESHTASTIC_EXCLUDE_MQTT        ; Kein Netzwerk verfügbar
  -DMESHTASTIC_EXCLUDE_WEBSERVER   ; Kein Netzwerk verfügbar
  -DNO_ESP32                       ; Kein ESP32
  -DMESHTASTIC_EXCLUDE_SCREEN      ; Kein Display
  -DMESHTASTIC_EXCLUDE_HEALTH_TELEMETRY   ; Keine Gesundheitssensoren
  ; Debug Reduzierung
  -DMESHTASTIC_EXCLUDE_DEBUG        ; Debug-Ausgaben deaktivieren
  -DMESHTASTIC_EXCLUDE_SERIAL       ; Serielle Ausgaben minimieren
  ; Diagnose Reduzierung
  -DMESHTASTIC_EXCLUDE_DIAGNOSTICS  ; Diagnose-Features deaktivieren
  ; Monitoring Reduzierung
  -DMESHTASTIC_EXCLUDE_MONITORING   ; Monitoring-Features deaktivieren
  ; Position Reduzierung
  -DMESHTASTIC_EXCLUDE_POSITION     ; Positions-Updates reduzieren
  ; Compiler Optimierungen
  -Os                              ; Optimiere für Größe
  -DLOWMEM                         ; Reduziere Speicherverbrauch
  ; Weitere Optimierungen
  -DMESHTASTIC_EXCLUDE_NOTIFICATIONS  ; Keine Benachrichtigungen
  -DMESHTASTIC_EXCLUDE_STORAGE       ; Minimale Speichernutzung
  -DMESHTASTIC_EXCLUDE_TEXT          ; Keine Textnachrichten
  ; RadioLib Optimierungen
  -DRADIOLIB_EXCLUDE_SX127X=1      ; Wir nutzen SX1262, nicht SX127X
  -DRADIOLIB_EXCLUDE_XBEE=1        ; Kein XBEE
  -DRADIOLIB_STATIC_ONLY=1         ; Nur statische Allokation
  -DRADIOLIB_EXCLUDE_HTTP=1        ; Kein HTTP
  ; Weitere Meshtastic Reduzierungen
  -DMESHTASTIC_EXCLUDE_RANGE_TEST=1  ; Kein Range-Test
  -DMESHTASTIC_EXCLUDE_ADMIN=1       ; Keine Admin-Features
  -DMESHTASTIC_EXCLUDE_COLLISION_AVOIDANCE=1  ; Keine Kollisionsvermeidung
  ; Speicher Optimierungen
  -DMESHTASTIC_MAX_CHANNELS=1      ; Minimale Anzahl Kanäle
  -DMESHTASTIC_MAX_PACKETS=4       ; Minimaler Paket-Buffer
  -DMESHTASTIC_EXCLUDE_FLASH=1     ; Minimale Flash-Nutzung
  ; Build Optimierungen (ohne LTO)
  -ffunction-sections            ; Entferne ungenutzte Funktionen
  -fdata-sections               ; Entferne ungenutzte Daten
  -Wl,--gc-sections            ; Garbage Collection für Sections
  ; Audio Ausschlüsse
  -DMESHTASTIC_EXCLUDE_AUDIO=1     ; Kein Audio Support
  -DMESHTASTIC_EXCLUDE_BUZZER=1    ; Kein Buzzer Support
  -DMESHTASTIC_EXCLUDE_TONE=1      ; Keine Töne
  -DMESHTASTIC_EXCLUDE_SOUND=1     ; Kein Sound
  ; CPU & Performance Optimierungen
  -DMESHTASTIC_REDUCE_TASK_STACK=1    ; Reduziere Stack-Größe der Tasks
  -DMESHTASTIC_REDUCE_TASK_PRIORITY=1 ; Reduziere Task-Prioritäten
  -DMESHTASTIC_REDUCE_POLLING=1       ; Reduziere Polling-Intervalle
  -DMESHTASTIC_SKIP_CHECKS=1          ; Überspringe nicht kritische Checks
  -DMESHTASTIC_REDUCE_TIMERS=1        ; Optimiere Timer-Nutzung
  -DMESHTASTIC_MINIMIZE_HEAP=1        ; Minimiere Heap-Allokationen
  -DMESHTASTIC_STATIC_ALLOCATOR=1     ; Nutze statische Allokation wo möglich
  -DMESHTASTIC_PREALLOCATE_MEMORY=1   ; Vorab-Allokation von Speicher
  -DMESHTASTIC_REDUCE_QUEUE_SIZE=1    ; Reduziere Queue-Größen
  -DMESHTASTIC_STATIC_QUEUES=1        ; Statische Queues statt dynamischer
  -DMESHTASTIC_STATIC_BUFFERS=1       ; Statische Puffer
  -DMESHTASTIC_NO_DYNAMIC_STRINGS=1   ; Keine dynamischen Strings
  -DMESHTASTIC_STATIC_MESH=1          ; Statisches Mesh-Netzwerk
  -DMESHTASTIC_FIXED_PAYLOAD_SIZE=1   ; Fixe Payload-Größe
  -DMESHTASTIC_STATIC_ROUTING=1       ; Statisches Routing
  -DCONFIG_PM_ENABLE                  ; Aktiviere Power Management
  -DCONFIG_FREERTOS_USE_TICKLESS_IDLE=1  ; Aktiviere Tickless Idle
  -DUSE_LIGHT_SLEEP=1                 ; Erlaube Light Sleep Mode

lib_deps =
  ${rp2040_base.lib_deps}
debug_build_flags = ${rp2040_base.build_flags}, -g
debug_tool = cmsis-dap ; for e.g. Picotool